{"code":"module.exports=function(e){var t={};function o(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,o),r.l=!0,r.exports}return o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,\"a\",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p=\"\",o(o.s=0)}([function(e,t,o){DEBUG=!1,LZString=o(!function(){var e=new Error(\"Cannot find module '../crypto/lz-string'\");throw e.code=\"MODULE_NOT_FOUND\",e}());var n=o(1);UrlBase64=o(!function(){var e=new Error(\"Cannot find module '../crypto/urlbase64'\");throw e.code=\"MODULE_NOT_FOUND\",e}());var r=o(!function(){var e=new Error(\"Cannot find module '../crypto/decimal-light'\");throw e.code=\"MODULE_NOT_FOUND\",e}()),s=o(!function(){var e=new Error(\"Cannot find module '../index'\");throw e.code=\"MODULE_NOT_FOUND\",e}()),i=(o(!function(){var e=new Error(\"Cannot find module '../crypto/sjcl'\");throw e.code=\"MODULE_NOT_FOUND\",e}()),o(!function(){var e=new Error(\"Cannot find module '../crypto/hex2base32'\");throw e.code=\"MODULE_NOT_FOUND\",e}()).hexToBase32),a=o(!function(){var e=new Error(\"Cannot find module '../crypto/proof'\");throw e.code=\"MODULE_NOT_FOUND\",e}()),c=o(!function(){var e=new Error(\"Cannot find module '../crypto/hashDJB2'\");throw e.code=\"MODULE_NOT_FOUND\",e}());if(\"undefined\"==typeof window&&(window={}),void 0===u)var u=o(2);\"undefined\"==typeof FormData&&(FormData={});e.exports={Interface:function(e){var t,o=e,l={},d={},f={},y={};this.init=function(e,t,o){this.logout(null,()=>{\"undefined\"==typeof nacl?nacl_factory.instantiate(function(e){nacl=e,window.nacl=nacl,\"function\"==typeof t&&t()}):\"function\"==typeof t&&t()},o)},this.logout=function(e,o,n){l={},t=void 0,\"function\"==typeof o&&o()},this.session=function(e,o,n){s.validateUserIDLength(e.username)?s.validatePasswordLength(e.password)?this.logout({},()=>{t=s.generateKeys(e.password,e.username,0),\"function\"==typeof o&&o()}):\"function\"==typeof n&&n(\"Invalid password.\"):\"function\"==typeof n&&n(\"Invalid username.\")},this.initAsset=function(e,o,n){if(!d.hasOwnProperty(e.assetDetails.mode.split(\".\")[0]))try{var r=LZString.decompressFromEncodedURIComponent(e.clientModuleCodeBlob),i=e.assetDetails.mode.split(\".\")[0];d[i]=s.activate(r),f[i]=e.clientModuleCodeBlob}catch(e){return DEBUG&&console.error(e),void(\"function\"==typeof n&&n(e))}l[e.assetDetails.symbol]=e.assetDetails,l[e.assetDetails.symbol].data={};var a=(i=e.assetDetails.mode.split(\".\"))[0],c=i[1],u=e.assetDetails.symbol;l[u].data.seed=s.seedGenerator(t,a);try{l[u].data.mode=c,l[u].data.keys=d[a].keys(l[u].data),l[u].data.keys.mode=c,l[u].data.address=d[a].address(l[u].data.keys)}catch(e){return DEBUG&&console.error(e),void(\"function\"==typeof n&&n(e))}o&&o(e.assetDetails.symbol)},this.import=function(e,t,o){try{var n=LZString.decompressFromEncodedURIComponent(e.blob);d[e.id]=s.activate(n),f[e.id]=e.blob}catch(e){DEBUG&&console.error(e),\"function\"==typeof o&&o(e)}t(e.id)},this.export=function(e,t,o){e.hasOwnProperty(\"id\")?f.hasOwnProperty(e.id)?e.callback(f[e.id]):(DEBUG&&console.error(\"No client module \"+e.id+\" not found.\"),\"function\"==typeof o&&o(\"No client module \"+e.id+\" not found.\")):(DEBUG&&console.error(\"No client module id provided.\"),\"function\"==typeof o&&o(\"No client module id provided.\"))},this.modules=function(e,t,o){t(Object.keys(d))},this.addAsset=function(e,t,o){l.hasOwnProperty(e.symbol)?void 0!==t&&t(e.symbol):this.call({host:e.host,query:\"/asset/\"+e.symbol+\"/details\",channel:e.channel},n=>{var r=n.mode.split(\".\")[0];d.hasOwnProperty(r)?this.initAsset({assetDetails:n},t,o):this.call({host:e.host,query:\"/source/deterministic/code/\"+r,channel:e.channel},e=>{this.initAsset({assetDetails:n,clientModuleCodeBlob:e},t,o)},o)},o)},this.proofOfWork=function(e,t,o){a(e.hash,t,o,e.difficulty)},this.client=function(e,t,o){var n,r;if(e.hasOwnProperty(\"id\"))n=e.id,r=n;else if(e.hasOwnProperty(\"symbol\")){if(!l.hasOwnProperty(e.symbol)||\"function\"!=typeof t)return DEBUG&&console.error(\"Asset \"+e.symbol+\" not initialized.\"),void(\"function\"==typeof o&&o(\"Asset \"+e.symbol+\" not initialized.\"));n=l[e.symbol].mode.split(\".\")[0],r=n+\"(\"+e.symbol+\")\"}else DEBUG&&console.error(\"Either data.id or data.symbol needs to be defined.\"),\"function\"==typeof o&&o(\"Either data.id or data.symbol needs to be defined.\");var i=()=>{if(d[n].hasOwnProperty(e.func)&&\"function\"==typeof d[n][e.func]){var s;try{s=d[n][e.func](e.data,t,o)}catch(e){return DEBUG&&console.error(e),void(\"function\"==typeof o&&o(e))}void 0!==s&&t(s)}else DEBUG&&console.error(\"Client module function \"+e.func+\" for \"+r+\" not defined or not a function.\"),\"function\"==typeof o&&o(\"Client module function \"+e.func+\" for \"+r+\" not defined or not a function.\")};d.hasOwnProperty(n)?i():this.call({host:e.host,query:\"/source/deterministic/code/\"+n,channel:e.channel},e=>{try{var t=LZString.decompressFromEncodedURIComponent(e);d[n]=s.activate(t),f[n]=e}catch(e){return DEBUG&&console.error(e),void(\"function\"==typeof o&&o(e))}i()},o)},this.getAddress=function(e,t,o){l.hasOwnProperty(e.symbol)&&\"function\"==typeof t?t(l[e.symbol].data.address):(DEBUG&&console.error(\"Asset \"+e.symbol+\" not initialized.\"),\"function\"==typeof o&&o(\"Asset \"+e.symbol+\" not initialized.\"))},this.getKeys=function(e,t,o){l.hasOwnProperty(e.symbol)&&\"function\"==typeof t?t(l[e.symbol].data.keys):(DEBUG&&console.error(\"Asset \"+e.symbol+\" not initialized.\"),\"function\"==typeof o&&o(\"Asset \"+e.symbol+\" not initialized.\"))},this.getPublicKey=function(e,t,o){l.hasOwnProperty(e.symbol)&&\"function\"==typeof t?l[e.symbol].data.keys.hasOwnProperty(\"publicKey\")?t(l[e.symbol].data.keys.publicKey):t(void 0):\"function\"==typeof o&&o(\"Asset \"+e.symbol+\" not initialized.\")},this.signTransaction=function(e,t,o){if(!l.hasOwnProperty(e.symbol))return DEBUG&&console.error(\"Asset \"+e.symbol+\" not added.\"),void(\"function\"==typeof o&&o(\"Asset \"+e.symbol+\" not added.\"));var n=l[e.symbol];if(!d.hasOwnProperty(n.mode.split(\".\")[0]))return DEBUG&&console.error(\"Asset \"+e.symbol+\" not initialized\"),void(\"function\"==typeof o&&o(\"Asset \"+e.symbol+\" not initialized.\"));var s,i,a=function(e,t){var o=Number(t);return new r(String(e)).times(\"1\"+(o>1?\"0\".repeat(o+1):\"\")).toString()};try{s=a(Number(e.fee||n.fee),n.factor)}catch(e){return DEBUG&&console.error(e),void(\"function\"==typeof o&&o(e))}try{i=a(Number(e.amount),n.factor)}catch(e){return DEBUG&&console.error(e),void(\"function\"==typeof o&&o(e))}var c,u={mode:n.data.keys.mode,symbol:n.symbol,source:n.data.address,target:e.target,amount:i,fee:s,factor:n.factor,contract:n.contract,keys:n.data.keys,seed:n.data.seed,unspent:e.unspent};try{c=d[n.mode.split(\".\")[0]].transaction(u,t)}catch(e){return DEBUG&&console.error(e),void(\"function\"==typeof o&&o(e))}void 0!==c&&\"function\"==typeof t&&t(c)},this.rawTransaction=function(e,t,o,n){this.sequential({steps:[{symbol:e.symbol},\"addAsset\",{symbol:e.symbol},\"getAddress\",t=>({query:\"/asset/\"+e.symbol+\"/unspent/\"+t+\"/\"+e.amount+\"/\"+e.target+\"/public_key\",channel:e.channel,host:e.host}),\"call\",t=>({symbol:e.symbol,target:e.target,amount:e.amount,fee:e.fee,unspent:t}),\"signTransaction\"]},t,o,n)},this.transaction=function(e,t,o,n){this.sequential({steps:[e,\"rawTransaction\",t=>({query:\"/asset/\"+e.symbol+\"/push/\"+t,channel:e.channel,host:e.host}),\"call\"]},t,o,n)},this.addHost=function(e,t,o){if(\"string\"==typeof e&&(e={host:e}),/^(http|https):\\/\\/[a-z\\d]([a-z\\d\\-]{0,61}[a-z\\d])?(\\.[a-z\\d]([a-z\\d\\-]{0,61}[a-z\\d])?)*:\\d*\\/$/i.test(e.host)||/^(http|https):\\/\\/((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?):\\d*\\/$/i.test(e.host)){var r=new n.HybriddNode(e.host);y[e.host]=r,t(e.host)}else DEBUG&&console.error('Host not valid hostname or IPv4 : \"'+e.host+'\"  expectected: \"protocol://hostnameOrIPv4Address:portnumber/\"'),\"function\"==typeof o&&o('Host not valid hostname or IPv4 : \"'+e.host+'\"  expectected: \"protocol://hostnameOrIPv4Address:portnumber/\"')},this.login=function(e,n,r){t?e.hasOwnProperty(\"host\")?y.hasOwnProperty(e.host)||this.addHost(e.host,()=>{y[e.host].init({userKeys:t,connector:o},n,r)},r):(DEBUG&&console.error(\"No host provided.\"),\"function\"==typeof r&&r(\"No host provided.\")):(DEBUG&&console.error(\"No session available.\"),\"function\"==typeof r&&r(\"No session available.\"))},this.call=function(e,n,r){var s;if(s=void 0===e.host?Object.keys(y)[0]:e.host,y.hasOwnProperty(s))switch(e.channel){case\"y\":y[s].yCall({query:e.query,channel:e.channel,userKeys:t,connector:o},n,r);break;case\"z\":y[s].zCall({query:e.query,channel:e.channel,userKeys:t,connector:o},n,r);break;default:y[s].call({query:e.query,connector:o},n,r)}else DEBUG&&console.error(\"Host not initialized\"),\"function\"==typeof r&&r(\"Host not initialized\")},this.createAccount=function(e,t,o){if(\"string\"===(e.entropy,!1)){if(!(e.entropy.length<482))return DEBUG&&console.error(\"Not enough entropy provided to function createAccount!\"),!1;e.entropy=u.randomBytes(482).toString()}var n;n=\"function\"==typeof e.pool?e.pool:function(e){return u.randomBytes(1600).toString(\"hex\")};var r=\"\",s=1e3+Math.floor(256*Math.random()),a=new Array(s).fill(0).map(()=>Math.floor(Math.random()*Math.pow(8,16))),l=e=>{if(e===s)if(r.required=491,r.length<r.required)DEBUG&&console.error(\"Entropy is of insufficient length. Required > \"+r.required),\"function\"==typeof o&&o(\"Entropy is of insufficient length. Required > \"+r.required);else{var u=Math.floor(411*Math.random()),d=i(r.substr(u+20,60)),f=i(r.substr(u,12)+c.hash(r.substr(u,12).toUpperCase()).substr(0,4)+c.hash(r.substr(u,12).toLowerCase()+d.toUpperCase()).substr(4,4));t({userid:f,passwd:d})}else r=n(a[e]),l(++e)};l(0)},this.id=((e,t,o)=>{t(e)}),this.callback=((e,t,o,n)=>{e.func(e,e,t,o,n)}),this.sequential=((e,t,o,n,r,s)=>{if(\"Array\"===e.constructor.name&&(e={steps:e}),void 0===r&&(r=0,s=e.steps.length),0===e.steps.length)\"function\"==typeof n&&n(1),t(e.data);else{\"function\"==typeof n&&n(r/s);var i,a=e.steps[0];if(\"string\"==typeof a)this.hasOwnProperty(a)?(DEBUG&&console.log(\"this.\"+a+\"(\"+JSON.stringify(e.data)+\")\"),\"function\"==typeof n&&(i=(e=>{n((r+e)/s)})),this[a](e.data,i=>{this.sequential({data:i,steps:e.steps.slice(1)},t,o,n,r+1,s)},o,i)):(DEBUG&&console.error('Method \"'+a+'\" does not exist for IoC.Interface class.'),\"function\"==typeof o&&o('Method \"'+a+'\" does not exist for IoC.Interface class.'));else if(\"object\"==typeof a)DEBUG&&console.log(JSON.stringify(e.data)+\" => \"+JSON.stringify(a)),this.sequential({data:a,steps:e.steps.slice(1)},t,o,n,r+1,s);else if(\"function\"==typeof a){var c=a(e.data);DEBUG&&console.log(JSON.stringify(e.data)+\" => \"+JSON.stringify(c)),this.sequential({data:c,steps:e.steps.slice(1)},t,o,n,r+1,s)}}}),this.parallel=((e,t,o,n)=>{var r,s=e,i=Object.keys(s).length,a={},c={};for(var u in s)c[u]=0;\"function\"==typeof n&&(r=(()=>{var e=0;for(var t in s)e+=c[t];n(e/i)}));var l={};if(0!==i){var d,f=e=>o=>{a.hasOwnProperty(e)||(c[e]=1,a[e]=!0,l[e]=o,\"function\"==typeof n&&r(),Object.keys(a).length===i&&t(l))},y=e=>o=>{a.hasOwnProperty(e)||(a[e]=!1,c[e]=1,l[e]=void 0,\"function\"==typeof n&&r(),Object.keys(a).length===i&&t(l))};\"function\"==typeof n&&(d=(e=>t=>{c[e]=t,r()}));var p=(e,t,n)=>{\"string\"==typeof t?this.hasOwnProperty(t)?this[t](n,f(e),y(e),d):(DEBUG&&console.error('Method \"'+t+'\" does not exist for IoC.Interface class.'),\"function\"==typeof o&&o('Method \"'+t+'\" does not exist for IoC.Interface class.')):\"function\"==typeof t&&t(n,f(e),y(e),d)};for(var u in s){var h=s[u];\"object\"==typeof h?h.hasOwnProperty(\"step\")?h.hasOwnProperty(\"data\")?p(u,h.step,h.data):p(u,h.step,e):(DEBUG&&console.error(\"No step defined.\"),\"function\"==typeof o&&o(\"No step defined.\")):p(u,h,e)}}else t({})})}}},function(e,t,o){var n=o(!function(){var e=new Error(\"Cannot find module '../ychan'\");throw e.code=\"MODULE_NOT_FOUND\",e}()),r=o(!function(){var e=new Error(\"Cannot find module '../zchan'\");throw e.code=\"MODULE_NOT_FOUND\",e}()),s=(o(!function(){var e=new Error(\"Cannot find module '../crypto/urlbase64'\");throw e.code=\"MODULE_NOT_FOUND\",e}()),o(!function(){var e=new Error(\"Cannot find module '../index'\");throw e.code=\"MODULE_NOT_FOUND\",e}()));e.exports={HybriddNode:function(e){var t,o,i,a,c,u,l=e;this.xAuthStep0Request=function(){return t=0,\"/x/\"+i.session_hexsign+\"/0\"},this.xAuthStep1Request=function(e){t=1;try{a=s.generateSecondarySessionData(e,i.session_hexkey,i.session_signpair.signSk)}catch(e){console.log(\"Error: \"+JSON.stringify(e))}return\"/x/\"+i.session_hexsign+\"/1/\"+a.crypt_hex},this.xAuthFinalize=function(e,t){u=e;var n={userKeys:t,nonce:o};Object.assign(n,u,i,a),c=s.sessionStep1Reply(e,n,()=>{})},this.yCall=function(e,o,r){t++;var s=n.getGeneralSessionData({user_keys:e.userKeys,nonce:c.current_nonce},t,c.sess_hex),i=n.encode_sub({sessionID:s.sessionID,sessionNonce:s.sessionNonce,serverSessionPubKey:s.serverSessionPubKey,clientSessionSecKey:s.clientSessionSecKey,step:t,txtdata:e.query});this.call({query:e.channel+\"/\"+i,connector:e.connector,meta:!0},t=>{var i=n.decode_sub({encdata:t,sessionNonce:s.sessionNonce,serverSessionPubKey:s.serverSessionPubKey,clientSessionSecKey:s.clientSessionSecKey});if(\"y\"===e.channel){try{e=JSON.parse(i)}catch(e){return DEBUG&&console.error(e),void(\"function\"==typeof r&&r(e))}o(e)}else o(i)},r)},this.zCall=function(e,o,n){\"function\"!=typeof n&&console.log(\"A NO ERROR FUNC!!!!\");var s=r.encode({user_keys:e.userKeys,nonce:c.current_nonce},t,e.query);this.yCall({query:s,channel:\"z\",userKeys:e.userKeys,connector:e.connector},e=>{var t,s=r.decode_sub(e);try{t=JSON.parse(s)}catch(e){return DEBUG&&console.error(e),void(\"function\"==typeof n&&n(e))}o(t)},n)},this.call=function(e,t,o){var n,r=!!e.meta;try{XMLHttpRequest}catch(e){e.name}try{http}catch(e){e.name}if(e.connector.hasOwnProperty(\"XMLHttpRequest\")&&(n=((t,o,n,r)=>{var s=new e.connector.XMLHttpRequest;s.onreadystatechange=(e=>{4===s.readyState&&(200===s.status?n(s.responseText):(DEBUG&&console.error(s.responseText),\"function\"==typeof r&&r(s.responseText)))}),s.open(\"GET\",t+o,!0),s.send()})),e.connector.hasOwnProperty(\"http\")&&(n=((t,o,n,r)=>{\"function\"==typeof r&&\"function\"==typeof n||console.log(\"B NO ERROR FUNC!!!!\"),e.connector.http.get(t+o,e=>{if(e.statusCode<200||e.statusCode>299){var t=\"Request error: Status Code: \"+e.statusCode;return DEBUG&&console.error(t),e.resume(),void(\"function\"==typeof r&&r(t))}e.setEncoding(\"utf8\");var o=[];e.on(\"data\",e=>{o.push(e)}),e.on(\"timeout\",()=>{e.resume(),DEBUG&&console.error(\"Request timed out.\"),\"function\"==typeof r&&r(\"Request timed out.\")}),e.on(\"error\",t=>{e.resume(),DEBUG&&console.error(`Got error: ${t.message}`),\"function\"==typeof r&&r(`Got error: ${t.message}`)}),e.on(\"end\",()=>{e.resume(),n(o.join(\"\"))})}).on(\"error\",e=>{DEBUG&&console.error(`Got error: ${e.message}`),\"function\"==typeof r&&r(`Got error: ${e.message}`)}).setTimeout(1e4,()=>{DEBUG&&console.error(\"Request timed out.\"),\"function\"==typeof r&&r(\"Request timed out\")})})),e.connector.hasOwnProperty(\"custom\")&&(n=e.connector.custom),void 0===n)return DEBUG&&console.error(\"Error: No http request connector method available.\"),void(\"function\"==typeof o&&o(\"Error: No http request connector method available.\"));e.query,n(l,e.query,e=>{var s;try{s=JSON.parse(e)}catch(e){return DEBUG&&console.error(e),void(\"function\"==typeof o&&o(e))}if(s.hasOwnProperty(\"id\")&&\"id\"===s.id){var i=()=>{n(l,\"/proc/\"+s.data,e=>{var n;try{n=JSON.parse(e)}catch(e){return DEBUG&&console.error(e),void(\"function\"==typeof o&&o(e))}n.hasOwnProperty(\"error\")&&0!==n.error?(DEBUG&&console.error(n),\"function\"==typeof o&&o(n.info)):null!==n.stopped?t(r?n:n.data):setTimeout(i,500)},o)};i()}else if(t){if(s.hasOwnProperty(\"error\")&&0!==s.error)return DEBUG&&console.error(s),void(\"function\"==typeof o&&o(e));t(r?s:s.data)}},o)},this.init=function(e,t,n){o=nacl.crypto_box_random_nonce(),i=s.generateInitialSessionData(o),this.call({query:this.xAuthStep0Request(),connector:e.connector,meta:!0},o=>{this.call({query:this.xAuthStep1Request(o.nonce1),connector:e.connector,meta:!0},o=>{this.xAuthFinalize(o,e.userKeys),t&&t(l)},n)},n)}}}},function(e,t){e.exports=require(\"crypto\")}]);","extractedComments":[]}